MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;*      *       *       *       *       *       *       *       *       *
                      00002 ;*                                                                      *
                      00003 ;*                         EXEMPLO6: PWM FINAL                          *
                      00004 ;*                   APOSTILA MÓDULO B  -  PIC16F877A                   *
                      00005 ;*                    ÁPICE TECNOLOGIA E TREINAMENTO                    *
                      00006 ;*          VERSÃO 1.0                          DATA:14/05/2005         *
                      00007 ;*                                                                      *
                      00008 ;*      *       *       *       *       *       *       *       *       *
                      00009 
                      00010 ;*      *       *       *       *       *       *       *       *       *
                      00011 ;*                       OBJETIVO DO ARQUIVO FONTE                      *
                      00012 ;*                                                                      *
                      00013 ;*  CONTROLAR A ROTAÇÃO DO VENTILADOR EXTERNO E DO RESITOR DE POTÊNCIA  *
                      00014 ;*  A PARTIR DO CONTROLE QUE SERÁ FEITO NO TECLADO MATRICIAL. O VALOR   *
                      00015 ;*    AJUSTADO SERÁ APRESENTADO NO DISPLAY E AJUSTADO NO MÓDULO CCP     *
                      00016 ;*                                                                      *
                      00017 ;*      *       *       *       *       *       *       *       *       *
                      00018 
                      00019  #INCLUDE <P16F877.INC>         ;ARQUIVO PADRÃO PARA PIC16F877A
                      00001         LIST
                      00002 ; P16F877.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
                      00373         LIST
2007   3F35           00020  __CONFIG _CP_OFF & _XT_OSC & _PWRTE_ON & _LVP_OFF & _WDT_ON & _BODEN_OFF & _CPD_OFF & _DEBUG_OFF
                      00021         
                      00022         ;NESTE PONTO É INFORMADO A CONFIGURAÇÃO DA MÁQUINA, OU SEJA, SE TERÁ
                      00023         ;CÓDIGO DE PROTEÇÃO OU O TIPO DE CRISTAL QUE SERÁ UTILIZADO     
                      00024 
                      00025         ;CONFIGURAÇÃO DA MÁQUINA
                      00026         ; CODE PROTECT                  -> DESLIGADO
                      00027         ; OSCILADOR                     -> CRISTAL OU RESSONADOR
                      00028         ; POWER-UP                      -> LIGADO
                      00029         ; DEBUF                         -> DESLIGADO            
                      00030         ; PROGRAMAÇÃO EM BAIXA VOLTAGEM -> DESLIGADO
                      00031         ; WATCH DOG                     -> LIGADO
                      00032         ; BROWN-OUT RESET               -> DESLIGADO
                      00033         ; PROTEÇÃO DE EEPROM            -> DESLIGADO
                      00034                 
                      00035 ;*      *       *       *       *       *       *       *       *       *
                      00036 ;*                         PAGINAÇÃO DE MEMÓRIA                         *
                      00037 ;*      *       *       *       *       *       *       *       *       *
                      00038 
                      00039 ; AQUI CRIAREMOS UM PSEUDÔNIMO PARA UM COMANDO. POR EXEMPLO, O COMANDO
                      00040 ; "BCF STATUS,RP0" PODE SER SUBSTITUÍDO SEM PROBLEMAS POR "BANK0". O 
                      00041 ; COMPILADOR IRÁ SUBSTITUIR INTERNAMENTE "BANK0" POR "BCF STATUS,RP0".
                      00042 ; ESTA APLICAÇÃO É VÁLIDA PARA OUTROS TIPOS DE COMANDOS
                      00043 
                      00044 #DEFINE BANK0   BCF     STATUS,RP0      ; ESCOLHE BANCO DE MEMÓRIA 0
                      00045 #DEFINE BANK1   BSF     STATUS,RP0      ; ESCOLHE BANCO DE MEMÓRIA 1
                      00046 
                      00047 ;*      *       *       *       *       *       *       *       *       *
                      00048 ;*                           DEFINICAO DE RAM                           *
                      00049 ;*      *       *       *       *       *       *       *       *       *
                      00050 
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00051 ; AQUI IREMOS CRIAR AS VARIÁVEIS DO NOSSO SISTEMA
                      00052 
                      00053         CBLOCK 0x20             ; INÍCIO DO BLOCO DE RAM(GPR)
  00000020            00054                 TEMPO1          ; VARIÁVEL DA ROTINA DE TEMPO           
  00000021            00055                 TEMPO2          ; VARIÁVEL DA ROTINA DE TEMPO                           
  00000022            00056                 TECLADO1        ; VARIÁVEL PARA MARCAR AS TECLAS  
  00000023            00057                 TECLADO2        ; VARIÁVEL PARA MARCAR AS TECLAS
  00000024            00058                 INDICE          ; VARIÁVEL DE ÍNDICE
  00000025            00059                 TEMP            ; VARIÁVEL TEMPORÁRIA           
  00000026            00060                 ARG0            ; PARÂMETRO DE ENTRADA PARA ROTINA DE
  00000027            00061                 ARG1            ; MULTIPLICAÇÃO E DIVISÃO
  00000028            00062                 ARG2
  00000029            00063                 MUL1            ; REGISTRADOR AUXILIAR PARA
  0000002A            00064                 MUL0            ; A ROTINA DE MULTIPLICAÇÃO/DIVISÃO
  0000002B            00065                 VEZES_TIMER2    ; VARIÁVEL AUXILIAR PARA INTERRUPÇÃO DE TIMER2
  0000002C            00066                 FLAGS           ; VARIÁVEL PARA DECLARAÇÃO DE FLAGS
  0000002D            00067                 CONTADOR_LSB    ; VARIÁVEL PARA ARMAZENAR 
  0000002E            00068                 CONTADOR_MSB    ; A CONTAGEM DO RX DE IR        
  0000002F            00069                 CONVERSAO_4     ; RETORNA DA CONVERSÃO DE BINÁRIO PARA DECIMAL
  00000030            00070                 CONVERSAO_3
  00000031            00071                 CONVERSAO_2
  00000032            00072                 CONVERSAO_1
  00000033            00073                 CONVERSAO_0
  00000034            00074                 MSB             ; PARÂMETRO DE ENTRADA PARA ROTINA
  00000035            00075                 LSB             ; DE CONVERSÃO BINÁRIO PARA DECIMAL             
                      00076         ENDC                    ; FIM DO BLOCO DE RAM(GPR)
                      00077         
                      00078         CBLOCK 0x70
  00000070            00079                 W_TEMP   ; VARIÁVEIS TEMPORÁRIAS
  00000071            00080                 STATUS_TEMP     
  00000072            00081                 FSR_TEMP
  00000073            00082                 PCLATH_TEMP
                      00083         ENDC
                      00084                 
                      00085 ;*      *       *       *       *       *       *       *       *       *
                      00086 ;*                        DEFINICAO DE FLAGS                            *
                      00087 ;*      *       *       *       *       *       *       *       *       *
                      00088 
                      00089 ; AQUI SÃO DEFINIDOS OS FLAGS QUE SERÃO UTILIZADOS PELO SISTEMA
                      00090 
                      00091 #DEFINE  TECLA_0        TECLADO1,0  ; TECLA 0 DO TECLADO MATRICIAL
                      00092 #DEFINE  TECLA_1        TECLADO1,1  ; TECLA 1 DO TECLADO MATRICIAL      
                      00093 #DEFINE  TECLA_2        TECLADO1,2  ; TECLA 2 DO TECLADO MATRICIAL      
                      00094 #DEFINE  TECLA_3        TECLADO1,3  ; TECLA 3 DO TECLADO MATRICIAL
                      00095 #DEFINE  TECLA_4        TECLADO1,4  ; TECLA 4 DO TECLADO MATRICIAL
                      00096 #DEFINE  TECLA_5        TECLADO1,5  ; TECLA 5 DO TECLADO MATRICIAL
                      00097 #DEFINE  TECLA_6        TECLADO1,6  ; TECLA 6 DO TECLADO MATRICIAL
                      00098 #DEFINE  TECLA_7        TECLADO1,7  ; TECLA 7 DO TECLADO MATRICIAL
                      00099 #DEFINE  TECLA_8        TECLADO2,0  ; TECLA 8 DO TECLADO MATRICIAL
                      00100 #DEFINE  TECLA_9        TECLADO2,1  ; TECLA 9 DO TECLADO MATRICIAL
                      00101 #DEFINE  TECLA_C        TECLADO2,2  ; TECLA CORRIGE DO TECLADO MATRICIAL
                      00102 #DEFINE  TECLA_E        TECLADO2,3  ; TECLA ENTER DO TECLADO MATRICIAL
                      00103 
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00104 #DEFINE MOSTRA_RPS_RPM  FLAGS,0     ; 1-> ATUALIZA O DISPLAY                    
                      00105         
                      00106 ;*      *       *       *       *       *       *       *       *       *
                      00107 ;*                      DEFINICAO DE CONSTANTES                         *
                      00108 ;*      *       *       *       *       *       *       *       *       *
                      00109 
                      00110 ; AQUI SÃO DEFINIDOS AS CONSTANTES QUE SERÃO UTILIZADOS PELO SISTEMA
                      00111 
                      00112 #DEFINE LINHA_SUP       0x80    ; CONSTANTE PARA LINHA SUPERIOR
                      00113 #DEFINE LINHA_INF       0xC0    ; CONSTANTE PARA LINHA INFERIOR
                      00114 
                      00115 #DEFINE SEL_LINHA1      B'00001110'  ; SELECIONA LINHA 1        
                      00116 #DEFINE SEL_LINHA2      B'00001101'  ; SELECIONA LINHA 2                
                      00117 #DEFINE SEL_LINHA3      B'00001011'  ; SELECIONA LINHA 3                
                      00118 #DEFINE SEL_LINHA4      B'00000111'  ; SELECIONA LINHA 4        
                      00119 
                      00120 ;*      *       *       *       *       *       *       *       *       *
                      00121 ;*                        ENTRADAS DO SISTEMA                           *
                      00122 ;*      *       *       *       *       *       *       *       *       *
                      00123 
                      00124 #DEFINE COL1            PORTA,4      ; PINO DE ENTRADA DA COLUNA1       
                      00125 #DEFINE COL2            PORTA,5      ; PINO DE ENTRADA DA COLUNA2               
                      00126 #DEFINE COL3            PORTE,0      ; PINO DE ENTRADA DA COLUNA3               
                      00127 
                      00128 ;*      *       *       *       *       *       *       *       *       *
                      00129 ;*                        SAÍDAS DO SISTEMA                             *
                      00130 ;*      *       *       *       *       *       *       *       *       *
                      00131 
                      00132 ; AQUI SÃO DEFINIDAS AS SAÍDAS QUE SERÃO UTILIZADOS PELO SISTEMA
                      00133 
                      00134 #DEFINE BUS             PORTD   ; DEFINE O BARRAMENTO COMO O PORTD 
                      00135 #DEFINE RS              PORTE,1 ; RS DO DISPLAY
                      00136 #DEFINE EN              PORTE,2 ; EN DO DISPLAY
                      00137 
                      00138 ;*      *       *       *       *       *       *       *       *       *
                      00139 ;*                          VETOR DE RESET                              *
                      00140 ;*      *       *       *       *       *       *       *       *       *
                      00141 
0000                  00142         ORG     0x0000          ; ENDEREÇO INICIAL DA MÁQUINA
0000   29BB           00143         GOTO    CONFIG_         ; SALTA PARA CONFIGURAR A MÁQUINA
                      00144 
                      00145 ;*      *       *       *       *       *       *       *       *       *
                      00146 ;*                       VETOR DE INTERRUPÇÃO                           *
                      00147 ;*      *       *       *       *       *       *       *       *       *
                      00148 
0004                  00149         ORG     0x0004          ; ENDEREÇO INICIAL DO VETOR DE INTERRUPÇÃO
0004                  00150 SALVA_CONTEXTO
0004   00F0           00151         MOVWF   W_TEMP          ; SALVA W
0005   0E03           00152         SWAPF   STATUS,W        
0006   00F1           00153         MOVWF   STATUS_TEMP     ; SALVA STATUS
0007   0804           00154         MOVF    FSR,W
0008   00F2           00155         MOVWF   FSR_TEMP        ; SALVA FSR     
Message[305]: Using default destination of 1 (file).
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009   088A           00156         MOVF    PCLATH  
000A   00F3           00157         MOVWF   PCLATH_TEMP     ; SALVA PCLATH
                      00158         
000B   0183           00159         CLRF    STATUS          ; GARANTE BANCO 0
000C   018A           00160         CLRF    PCLATH          ; GARANTE PÁGINA 0
                      00161         
000D   190B           00162         BTFSC   INTCON,T0IF     ; INTERRUPÇÃO DE TIMER0?
000E   281A           00163         GOTO    TRATA_TIMER0    ; SIM, ENTÃO TRATA
                      00164         
000F   188C           00165         BTFSC   PIR1,TMR2IF     ; INTERRUPÇÃO DE TIMER2?
0010   2853           00166         GOTO    TRATA_TIMER2    ; SIM, ENTÃO TRATA
                      00167                 
0011                  00168 SAI_INTERRUPCAO 
0011   0872           00169         MOVF    FSR_TEMP,W
0012   0084           00170         MOVWF   FSR             ; RECUPERA FSR
0013   0873           00171         MOVF    PCLATH_TEMP,W   
0014   008A           00172         MOVWF   PCLATH          ; RECUPERA PCLATH
0015   0E71           00173         SWAPF   STATUS_TEMP,W
0016   0083           00174         MOVWF   STATUS          ; RECUPERA STATUS
0017   0EF0           00175         SWAPF   W_TEMP,F
0018   0E70           00176         SWAPF   W_TEMP,W        ; RECUPERA W
0019   0009           00177         RETFIE                  ; RETORNA DA INTERRUPÇÃO
                      00178 
                      00179 ;*      *       *       *       *       *       *       *       *       *
                      00180 ;*                  TRATATAMENTO DE INTERRUPÇÃO DE TIMER0               *
                      00181 ;*      *       *       *       *       *       *       *       *       *
                      00182 
001A                  00183 TRATA_TIMER0
                      00184         
001A   110B           00185         BCF     INTCON,T0IF      ; LIMPA FLAG DE INTERRUPÇÃO
Message[305]: Using default destination of 1 (file).
001B   0AA4           00186         INCF    INDICE           ; INCREMENTA INDICE 
001C   3003           00187         MOVLW   B'00000011'      
001D   0524           00188         ANDWF   INDICE,W         ; MASCARA OS BITS SUPERIORES   
001E   0782           00189         ADDWF   PCL,F            ; SOMA CONTEÚDO COM PCL        
001F   2823           00190         GOTO    VERIFICA_LINHA1  ; SALTA PARA TRATAR A LINHA 1
0020   282F           00191         GOTO    VERIFICA_LINHA2  ; SALTA PARA TRATAR A LINHA 2
0021   283B           00192         GOTO    VERIFICA_LINHA3  ; SALTA PARA TRATAR A LINHA 3
0022   2847           00193         GOTO    VERIFICA_LINHA4  ; SALTA PARA TRATAR A LINHA 4
                      00194         
                      00195 
0023                  00196 VERIFICA_LINHA1
                      00197         
0023   300E           00198         MOVLW   SEL_LINHA1      
0024   0088           00199         MOVWF   BUS             ; SELECIONA A LINHA 1   
                      00200         
0025   10A2           00201         BCF     TECLA_1         ; LIMPA FLAG DA TECLA 1 PRESSIONADA
0026   1122           00202         BCF     TECLA_2         ; LIMPA FLAG DA TECLA 2 PRESSIONADA
0027   11A2           00203         BCF     TECLA_3         ; LIMPA FLAG DA TECLA 3 PRESSIONADA
                      00204                 
0028   1E05           00205         BTFSS   COL1            ; COLUNA1 ESTÁ PRESSIONADA?
0029   14A2           00206         BSF     TECLA_1         ; SIM, ENTÃO SETA TECLA_1
                      00207         
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002A   1E85           00208         BTFSS   COL2            ; COLUNA2 ESTÁ PRESSIONADA?
002B   1522           00209         BSF     TECLA_2         ; SIM, ENTÃO SETA TECLA_2
                      00210         
002C   1C09           00211         BTFSS   COL3            ; COLUNA3 ESTÁ PRESSIONADA?
002D   15A2           00212         BSF     TECLA_3         ; SIM, ENTÃO SETA TECLA_3
                      00213         
002E   2811           00214         GOTO    SAI_INTERRUPCAO ; SAI DA INTERRUPÇÃO
                      00215         
002F                  00216 VERIFICA_LINHA2
                      00217         
002F   300D           00218         MOVLW   SEL_LINHA2
0030   0088           00219         MOVWF   BUS             ; SELECIONA A LINHA 2   
                      00220         
0031   1222           00221         BCF     TECLA_4         ; LIMPA FLAG DA TECLA 4 PRESSIONADA
0032   12A2           00222         BCF     TECLA_5         ; LIMPA FLAG DA TECLA 5 PRESSIONADA
0033   1322           00223         BCF     TECLA_6         ; LIMPA FLAG DA TECLA 6 PRESSIONADA
                      00224                 
0034   1E05           00225         BTFSS   COL1            ; COLUNA1 ESTÁ PRESSIONADA?
0035   1622           00226         BSF     TECLA_4         ; SIM, ENTÃO SETA TECLA_4
                      00227         
0036   1E85           00228         BTFSS   COL2            ; COLUNA2 ESTÁ PRESSIONADA?
0037   16A2           00229         BSF     TECLA_5         ; SIM, ENTÃO SETA TECLA_5
                      00230         
0038   1C09           00231         BTFSS   COL3            ; COLUNA3 ESTÁ PRESSIONADA?
0039   1722           00232         BSF     TECLA_6         ; SIM, ENTÃO SETA TECLA_6
                      00233         
003A   2811           00234         GOTO    SAI_INTERRUPCAO ; SAI DA INTERRUPÇÃO
                      00235 
003B                  00236 VERIFICA_LINHA3
                      00237         
003B   300B           00238         MOVLW   SEL_LINHA3
003C   0088           00239         MOVWF   BUS             ; SELECIONA A LINHA 3   
                      00240         
003D   13A2           00241         BCF     TECLA_7         ; LIMPA FLAG DA TECLA 7 PRESSIONADA
003E   1023           00242         BCF     TECLA_8         ; LIMPA FLAG DA TECLA 8 PRESSIONADA
003F   10A3           00243         BCF     TECLA_9         ; LIMPA FLAG DA TECLA 9 PRESSIONADA
                      00244                 
0040   1E05           00245         BTFSS   COL1            ; COLUNA1 ESTÁ PRESSIONADA?
0041   17A2           00246         BSF     TECLA_7         ; SIM, ENTÃO SETA TECLA_7
                      00247         
0042   1E85           00248         BTFSS   COL2            ; COLUNA2 ESTÁ PRESSIONADA?
0043   1423           00249         BSF     TECLA_8         ; SIM, ENTÃO SETA TECLA_8
                      00250         
0044   1C09           00251         BTFSS   COL3            ; COLUNA3 ESTÁ PRESSIONADA?
0045   14A3           00252         BSF     TECLA_9         ; SIM, ENTÃO SETA TECLA_9
                      00253         
0046   2811           00254         GOTO    SAI_INTERRUPCAO ; SAI DA INTERRUPÇÃO
                      00255 
0047                  00256 VERIFICA_LINHA4
                      00257         
0047   3007           00258         MOVLW   SEL_LINHA4      
0048   0088           00259         MOVWF   BUS             ; SELECIONA A LINHA 4   
                      00260         
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0049   11A3           00261         BCF     TECLA_E         ; LIMPA FLAG DA TECLA ENTER PRESSIONADA
004A   1123           00262         BCF     TECLA_C         ; LIMPA FLAG DA TECLA CORRIGE PRESSIONADA
004B   1022           00263         BCF     TECLA_0         ; LIMPA FLAG DA TECLA 0 PRESSIONADA
                      00264                 
004C   1E05           00265         BTFSS   COL1            ; COLUNA1 ESTÁ PRESSIONADA?
004D   1523           00266         BSF     TECLA_C         ; SIM, ENTÃO SETA TECLA_C
                      00267         
004E   1E85           00268         BTFSS   COL2            ; COLUNA2 ESTÁ PRESSIONADA?
004F   1422           00269         BSF     TECLA_0         ; SIM, ENTÃO SETA TECLA_0
                      00270         
0050   1C09           00271         BTFSS   COL3            ; COLUNA3 ESTÁ PRESSIONADA?
0051   15A3           00272         BSF     TECLA_E         ; SIM, ENTÃO SETA TECLA_E
                      00273         
0052   2811           00274         GOTO    SAI_INTERRUPCAO ; SAI DA INTERRUPÇÃO
                      00275 
                      00276 ;*      *       *       *       *       *       *       *       *       *
                      00277 ;*                  TRATATAMENTO DA INTERRUPÇÃO DE TIMER2               *
                      00278 ;*      *       *       *       *       *       *       *       *       *
                      00279 
0053                  00280 TRATA_TIMER2
                      00281 
0053   108C           00282         BCF     PIR1,TMR2IF
                      00283         
0054   0BAB           00284         DECFSZ  VEZES_TIMER2,F  ; DECREMENTA VEZES_TIMER2, ACABOU?
0055   2811           00285         GOTO    SAI_INTERRUPCAO ; NÃO, ENTÃO SAI DA INTERRUPÇÃO
                      00286         
0056   3064           00287         MOVLW   .100
0057   00AB           00288         MOVWF   VEZES_TIMER2    ; RECARREGA VEZES_TIMER2
                      00289         
0058   1010           00290         BCF     T1CON,TMR1ON    ; DESLIGA TIMER1
                      00291         
0059   080E           00292         MOVF    TMR1L,W
005A   00AD           00293         MOVWF   CONTADOR_LSB
005B   080F           00294         MOVF    TMR1H,W
005C   00AE           00295         MOVWF   CONTADOR_MSB    ; SALVA VALOR DA CONTAGEM
                      00296         
005D   018E           00297         CLRF    TMR1L           ; LIMPA VARIÁVEIS DE CONTAGEM
005E   018F           00298         CLRF    TMR1H
                      00299         
005F   142C           00300         BSF     MOSTRA_RPS_RPM  ; SETA FLAG PARA MOSTRAR RPS E RPM
                      00301         
0060   1410           00302         BSF     T1CON,TMR1ON    ; LIGA O TIMER 1
                      00303         
0061   2811           00304         GOTO    SAI_INTERRUPCAO ; SAI DA INTERRUPÇÃO
                      00305 
                      00306 ;*      *       *       *       *       *       *       *       *       *
                      00307 ;*                    ROTINA DE 4ÇÃO 8x8                        *
                      00308 ;*                        ENTRADAS: ARG1:ARG0                           *       
                      00309 ;*                         SAÍDA: ARG1:ARG0                             *
                      00310 ;*                  VARIÁVEIS AUXILIARES: MUL1:MUL0                     *
                      00311 ;*      *       *       *       *       *       *       *       *       *
                      00312 
0062                  00313 MULTIPLICACAO
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00314 
0062   08A6           00315         MOVF    ARG0,F          ; VERIFICA SE ALGUMA DAS VARIÁVEIS
0063   1903           00316         BTFSC   STATUS,Z        ; É NULA        
0064   2875           00317         GOTO    SAI_EM_0
                      00318         
0065   08A7           00319         MOVF    ARG1,F
0066   1903           00320         BTFSC   STATUS,Z
0067   2875           00321         GOTO    SAI_EM_0
                      00322         
0068   01A9           00323         CLRF    MUL1
0069   01AA           00324         CLRF    MUL0
                      00325         
006A                  00326 MULT
006A   0826           00327         MOVF    ARG0,W          ; FAZ A SOMA SUCESSIVA, OU SEJA
006B   07AA           00328         ADDWF   MUL0,F          ; A MULTIPLICAÇÃO
006C   1803           00329         BTFSC   STATUS,C
006D   0AA9           00330         INCF    MUL1,F
                      00331         
006E   0BA7           00332         DECFSZ  ARG1,F
006F   286A           00333         GOTO    MULT
                      00334 
0070                  00335 SAI_COM_DADO
                      00336         
0070   0829           00337         MOVF    MUL1,W          ; RETORNA O VALOR DA MULTIPLICAÇÃO
0071   00A7           00338         MOVWF   ARG1
0072   082A           00339         MOVF    MUL0,W
0073   00A6           00340         MOVWF   ARG0
0074   0008           00341         RETURN
                      00342                 
0075                  00343 SAI_EM_0
                      00344         
0075   01A6           00345         CLRF    ARG0
0076   01A7           00346         CLRF    ARG1
0077   0008           00347         RETURN  
                      00348 
                      00349 ;*      *       *       *       *       *       *       *       *       *
                      00350 ;*                      ROTINA DE DIVISÃO DE 16 BITS                    *
                      00351 ;*              ENTRADAS: DIVIDENDO(ARG1:ARG0) DIVISOR(ARG2)            *
                      00352 ;*                          SAÍDA: ARG1:ARG0                            *
                      00353 ;*                   VARIÁVEIS AUXILIARES: MUL1:MUL0                    *
                      00354 ;*      *       *       *       *       *       *       *       *       *
                      00355 
0078                  00356 DIVIDE
0078   01A9           00357         CLRF    MUL1            ; INICIALIZA REGISTRADORES AUXILIARES
0079   01AA           00358         CLRF    MUL0
                      00359         
007A   08A8           00360         MOVF    ARG2,F          ; VERIFICA SE O DIVISOR É IGUAL A 0
007B   1903           00361         BTFSC   STATUS,Z
007C   2875           00362         GOTO    SAI_EM_0        ; CASO SEJA, RETORNA EM 0
                      00363         
007D   08A6           00364         MOVF    ARG0,F          ; VERIFICA SE O DIVIDENDO É ZERO
007E   1D03           00365         BTFSS   STATUS,Z
007F   2883           00366         GOTO    DIVIDE_A
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00367         
0080   08A7           00368         MOVF    ARG1,F
0081   1903           00369         BTFSC   STATUS,Z
0082   2875           00370         GOTO    SAI_EM_0        ; CASO SEJA, RETORNA EM 0
                      00371         
0083                  00372 DIVIDE_A
                      00373 
0083   0828           00374         MOVF    ARG2,W          ; FAZ A SUBTRAÇÃO SUCESSIVA, OU SEJA, 
0084   02A6           00375         SUBWF   ARG0,F          ; A DIVISÃO     
0085   1C03           00376         BTFSS   STATUS,C
0086   288B           00377         GOTO    DIVIDE_B
                      00378 
0087                  00379 DIVIDE_C
                      00380 
0087   0AAA           00381         INCF    MUL0,F
0088   1903           00382         BTFSC   STATUS,Z
0089   0AA9           00383         INCF    MUL1,F
008A   2883           00384         GOTO    DIVIDE_A
                      00385 
008B                  00386 DIVIDE_B
                      00387 
008B   08A7           00388         MOVF    ARG1,F
008C   1903           00389         BTFSC   STATUS,Z
008D   2870           00390         GOTO    SAI_COM_DADO    ; RETORNA COMO O VALOR DA DIVISÃO
008E   03A7           00391         DECF    ARG1,F
008F   2887           00392         GOTO    DIVIDE_C
                      00393         
                      00394 ;*      *       *       *       *       *       *       *       *       *
                      00395 ;*                    ROTINA DE DELAY DE 1ms A 256ms                    *
                      00396 ;*      *       *       *       *       *       *       *       *       *
                      00397 
0090                  00398 DELAY_MS
                      00399         
0090   0064           00400         CLRWDT
                      00401         
0091   00A1           00402         MOVWF   TEMPO2          ; SALVA O VALOR MULTIPLICADOR
0092   01A0           00403         CLRF    TEMPO1          ; LIMPA REGISTRADOR
                      00404 
0093                  00405 DELAY_A
                      00406         
0093   0000           00407         NOP                     ; PERDE 1 CICLO DE MÁQUINA
0094   0BA0           00408         DECFSZ  TEMPO1,F        ; DECREMENTA REGISTRADOR, ACABOU?
0095   2893           00409         GOTO    $-2             ; NÃO, ENTÃO RETORNA DUAS POSIÇÕES 
0096   0BA1           00410         DECFSZ  TEMPO2,F
0097   2893           00411         GOTO    DELAY_A
                      00412         
0098   0008           00413         RETURN                  ; RETORNA DA INTERRUPÇÃO
                      00414 
                      00415 ;*      *       *       *       *       *       *       *       *       *
                      00416 ;*                ROTINA PARA ESCREVER DADOS NO DISPLAY                 *
                      00417 ;*      *       *       *       *       *       *       *       *       *
                      00418 
0099                  00419 ENVIA_COMANDO
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00420         
0099   1089           00421         BCF     RS              ; PÕE EM MODO DE COMANDO
                      00422         
009A                  00423 ENVIA_DADO
                      00424         
009A   138B           00425         BCF     INTCON,GIE      ; DESLIGA A INTERRUPÇÃO
                      00426         
009B   0088           00427         MOVWF   BUS             ; MOVE DADO PARA O PORTD
                      00428                 
009C   289D           00429         GOTO    $+1             ; DEÇAY PARA ACOMODAÇÃO
009D   289E           00430         GOTO    $+1             
                      00431         
009E   1509           00432         BSF     EN              ; GERA PULSO DE CLOCK
009F   28A0           00433         GOTO    $+1
00A0   1109           00434         BCF     EN
                      00435         
00A1   1489           00436         BSF     RS              ; VOLTA PARA O MODO DADOS
00A2   3001           00437         MOVLW   .1
00A3   2090           00438         CALL    DELAY_MS
00A4   178B           00439         BSF     INTCON,GIE      ; LIGA A INTERRUPÇÃO
00A5   0008           00440         RETURN                  ; RETORNA DA INTERRUPÇÃO
                      00441 
                      00442 ;*      *       *       *       *       *       *       *       *       *
                      00443 ;*                   ROTINA DE ATUALIZAÇÃO DA TELA DO LCD               *
                      00444 ;*      *       *       *       *       *       *       *       *       *
                      00445 
00A6                  00446 ATUALIZA_TELA
                      00447         
                      00448         
00A6   3080           00449         MOVLW   0x80
00A7   2099           00450         CALL    ENVIA_COMANDO   ; COMANDO PARA POSICIONAR O DISPLAY
                      00451         
00A8   3056           00452         MOVLW   'V'
00A9   209A           00453         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00454         
00AA   3074           00455         MOVLW   't'
00AB   209A           00456         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00457         
00AC   303A           00458         MOVLW   ':'
00AD   209A           00459         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00460         
00AE   3020           00461         MOVLW   ' '
00AF   209A           00462         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00463         
00B0   3030           00464         MOVLW   '0'
00B1   209A           00465         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00466         
00B2   3020           00467         MOVLW   ' '
00B3   209A           00468         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00469                 
00B4   3025           00470         MOVLW   '%'
00B5   209A           00471         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00472         
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B6   3020           00473         MOVLW   ' '
00B7   209A           00474         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00475         
00B8   3052           00476         MOVLW   'R'
00B9   209A           00477         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00478         
00BA   3065           00479         MOVLW   'e'
00BB   209A           00480         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00481         
00BC   3073           00482         MOVLW   's'
00BD   209A           00483         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00484         
00BE   303A           00485         MOVLW   ':'
00BF   209A           00486         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00487         
00C0   3020           00488         MOVLW   ' '
00C1   209A           00489         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00490                 
00C2   3030           00491         MOVLW   '0'
00C3   209A           00492         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00493         
00C4   3020           00494         MOVLW   ' '
00C5   209A           00495         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00496         
00C6   3025           00497         MOVLW   '%'
00C7   209A           00498         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00499         
00C8   30C0           00500         MOVLW   0xC0
00C9   2099           00501         CALL    ENVIA_COMANDO
                      00502         
00CA   3020           00503         MOVLW   ' '
00CB   209A           00504         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00505                 
00CC   3030           00506         MOVLW   '0'
00CD   209A           00507         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00508         
00CE   3020           00509         MOVLW   ' '
00CF   209A           00510         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00511         
00D0   3048           00512         MOVLW   'H'
00D1   209A           00513         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00514         
00D2   307A           00515         MOVLW   'z'
00D3   209A           00516         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00517         
                      00518         
00D4   3020           00519         MOVLW   ' '
00D5   209A           00520         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00521                 
00D6   3020           00522         MOVLW   ' '
00D7   209A           00523         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00524         
00D8   3020           00525         MOVLW   ' '
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D9   209A           00526         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00527         
00DA   3030           00528         MOVLW   '0'
00DB   209A           00529         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00530         
00DC   3020           00531         MOVLW   ' '
00DD   209A           00532         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00533         
00DE   3052           00534         MOVLW   'R'
00DF   209A           00535         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00536         
00E0   304D           00537         MOVLW   'M'
00E1   209A           00538         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00539         
00E2   3020           00540         MOVLW   ' '
00E3   209A           00541         CALL    ENVIA_DADO
                      00542         
00E4   3020           00543         MOVLW   ' '
00E5   209A           00544         CALL    ENVIA_DADO
                      00545         
00E6   3020           00546         MOVLW   ' '
00E7   209A           00547         CALL    ENVIA_DADO
                      00548         
00E8   3043           00549         MOVLW   'C'
00E9   209A           00550         CALL    ENVIA_DADO
                      00551         
00EA   0008           00552         RETURN                  ; RETORNA DA ROTINA     
                      00553 
                      00554 ;*      *       *       *       *       *       *       *       *       *
                      00555 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 0%                 *
                      00556 ;*      *       *       *       *       *       *       *       *       *
                      00557 
00EB                  00558 ATUALIZA_0
                      00559         
00EB   00A5           00560         MOVWF   TEMP
                      00561         
00EC   3A83           00562         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
00ED   3000           00563         MOVLW   .0              ; O CCP1 OU O CCP2
00EE   1D03           00564         BTFSS   STATUS,Z
00EF   009B           00565         MOVWF   CCPR2L
00F0   1903           00566         BTFSC   STATUS,Z
00F1   0095           00567         MOVWF   CCPR1L
                      00568         
00F2   0825           00569         MOVF    TEMP,W          ; POSICIONA LINHA DO DISPLAY
00F3   2099           00570         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00571         
00F4   3020           00572         MOVLW   ' '
00F5   209A           00573         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00574         
00F6   3030           00575         MOVLW   '0'
00F7   209A           00576         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00577         
00F8   3020           00578         MOVLW   ' '
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00F9   209A           00579         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00580         
00FA   0008           00581         RETURN                  ; RETORNA DA ROTINA     
                      00582 
                      00583 
                      00584 ;*      *       *       *       *       *       *       *       *       *
                      00585 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 20%                *
                      00586 ;*      *       *       *       *       *       *       *       *       *
                      00587 
00FB                  00588 ATUALIZA_20
                      00589         
00FB   00A5           00590         MOVWF   TEMP
                      00591         
00FC   3A83           00592         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
00FD   3032           00593         MOVLW   .50             ; O CCP1 OU O CCP2
00FE   1D03           00594         BTFSS   STATUS,Z
00FF   009B           00595         MOVWF   CCPR2L
0100   1903           00596         BTFSC   STATUS,Z
0101   0095           00597         MOVWF   CCPR1L
                      00598 
0102   0825           00599         MOVF    TEMP,W
0103   2099           00600         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00601         
0104   3020           00602         MOVLW   ' '
0105   209A           00603         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00604         
0106   3032           00605         MOVLW   '2'
0107   209A           00606         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00607         
0108   3030           00608         MOVLW   '0'
0109   209A           00609         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00610         
010A   0008           00611         RETURN                  ; RETORNA DA ROTINA     
                      00612 
                      00613 ;*      *       *       *       *       *       *       *       *       *
                      00614 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 40%                *
                      00615 ;*      *       *       *       *       *       *       *       *       *
                      00616 
010B                  00617 ATUALIZA_40
                      00618         
010B   00A5           00619         MOVWF   TEMP
                      00620         
010C   3A83           00621         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
010D   3065           00622         MOVLW   .101            ; O CCP1 OU O CCP2
010E   1D03           00623         BTFSS   STATUS,Z
010F   009B           00624         MOVWF   CCPR2L
0110   1903           00625         BTFSC   STATUS,Z
0111   0095           00626         MOVWF   CCPR1L
                      00627 
0112   0825           00628         MOVF    TEMP,W
0113   2099           00629         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00630         
0114   3020           00631         MOVLW   ' '
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0115   209A           00632         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00633         
0116   3034           00634         MOVLW   '4'
0117   209A           00635         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00636         
0118   3030           00637         MOVLW   '0'
0119   209A           00638         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00639         
011A   0008           00640         RETURN                  ; RETORNA DA ROTINA     
                      00641 
                      00642 ;*      *       *       *       *       *       *       *       *       *
                      00643 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 60%                *
                      00644 ;*      *       *       *       *       *       *       *       *       *
                      00645 
011B                  00646 ATUALIZA_60
                      00647         
011B   00A5           00648         MOVWF   TEMP
                      00649         
011C   3A83           00650         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
011D   3098           00651         MOVLW   .152            ; O CCP1 OU O CCP2
011E   1D03           00652         BTFSS   STATUS,Z
011F   009B           00653         MOVWF   CCPR2L
0120   1903           00654         BTFSC   STATUS,Z
0121   0095           00655         MOVWF   CCPR1L
                      00656 
0122   0825           00657         MOVF    TEMP,W
0123   2099           00658         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00659         
0124   3020           00660         MOVLW   ' '
0125   209A           00661         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00662         
0126   3036           00663         MOVLW   '6'
0127   209A           00664         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00665         
0128   3030           00666         MOVLW   '0'
0129   209A           00667         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00668         
012A   0008           00669         RETURN                  ; RETORNA DA ROTINA     
                      00670 
                      00671 ;*      *       *       *       *       *       *       *       *       *
                      00672 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 80%                *
                      00673 ;*      *       *       *       *       *       *       *       *       *
                      00674 
012B                  00675 ATUALIZA_80
                      00676         
012B   00A5           00677         MOVWF   TEMP
                      00678         
012C   3A83           00679         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
012D   30CB           00680         MOVLW   .203            ; O CCP1 OU O CCP2
012E   1D03           00681         BTFSS   STATUS,Z
012F   009B           00682         MOVWF   CCPR2L
0130   1903           00683         BTFSC   STATUS,Z
0131   0095           00684         MOVWF   CCPR1L
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00685 
0132   0825           00686         MOVF    TEMP,W
0133   2099           00687         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00688         
0134   3020           00689         MOVLW   ' '
0135   209A           00690         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00691         
0136   3038           00692         MOVLW   '8'
0137   209A           00693         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00694         
0138   3030           00695         MOVLW   '0'
0139   209A           00696         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00697         
013A   0008           00698         RETURN                  ; RETORNA DA ROTINA     
                      00699 
                      00700 ;*      *       *       *       *       *       *       *       *       *
                      00701 ;*                  ROTINA PARA ATUALIZAR A FAIXA DE 100%               *
                      00702 ;*      *       *       *       *       *       *       *       *       *
                      00703 
013B                  00704 ATUALIZA_100
                      00705         
013B   00A5           00706         MOVWF   TEMP
                      00707         
013C   3A83           00708         XORLW   0x83            ; VERIFICA SE É PARA ATUALIZAR
013D   30FF           00709         MOVLW   .255            ; O CCP1 OU O CCP2
013E   1D03           00710         BTFSS   STATUS,Z
013F   009B           00711         MOVWF   CCPR2L
0140   1903           00712         BTFSC   STATUS,Z
0141   0095           00713         MOVWF   CCPR1L
                      00714 
0142   0825           00715         MOVF    TEMP,W
0143   2099           00716         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR COMANDO
                      00717         
0144   3031           00718         MOVLW   '1'
0145   209A           00719         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00720         
0146   3030           00721         MOVLW   '0'
0147   209A           00722         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00723         
0148   3030           00724         MOVLW   '0'
0149   209A           00725         CALL    ENVIA_DADO      ; ENVIA CARACTER ASCII  
                      00726         
014A   0008           00727         RETURN                  ; RETORNA DA ROTINA     
                      00728 
                      00729 ;*      *       *       *       *       *       *       *       *       *
                      00730 ;*                  ROTINA PARA ATUALIZAR O RPS E O RPM                 *
                      00731 ;*      *       *       *       *       *       *       *       *       *
                      00732 
014B                  00733 ATUALIZA_RPS_RPM
                      00734         
014B   102C           00735         BCF     MOSTRA_RPS_RPM  ; LIMPA FLAG
                      00736         
014C   082D           00737         MOVF    CONTADOR_LSB,W
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

014D   00A6           00738         MOVWF   ARG0
014E   082E           00739         MOVF    CONTADOR_MSB,W  ; DIVIDE O RESULTADO DO CONTADOR PELO 
014F   00A7           00740         MOVWF   ARG1            ; NÚMERO DE ALETAS, NESSE CASO 7
0150   3007           00741         MOVLW   .7
0151   00A8           00742         MOVWF   ARG2
0152   2078           00743         CALL    DIVIDE
0153   0826           00744         MOVF    ARG0,W
0154   00B5           00745         MOVWF   LSB
0155   01B4           00746         CLRF    MSB
0156   218D           00747         CALL    BIN_TO_DEC      ; CONVERTE PARA DECIMAL
0157   2164           00748         CALL    ATUALIZA_TELA_RPS ; ATUALIZA A TELA DE RPS
                      00749         
0158   0826           00750         MOVF    ARG0,W          ; MULTIPLICA O RESULTADO ANTERIOR       
0159   00A7           00751         MOVWF   ARG1            ; POR 60 PARA ACHAR O RPM
015A   303C           00752         MOVLW   .60
015B   00A6           00753         MOVWF   ARG0
015C   2062           00754         CALL    MULTIPLICACAO
015D   0827           00755         MOVF    ARG1,W
015E   00B4           00756         MOVWF   MSB
015F   0826           00757         MOVF    ARG0,W
0160   00B5           00758         MOVWF   LSB
0161   218D           00759         CALL    BIN_TO_DEC      ; CONVERTE RESULTADO PARA DECIMAL
0162   2170           00760         CALL    ATUALIZA_RPM    ; CHAMA ROTINA PARA ATUALIZAR O DISPLAY
                      00761         
0163   0008           00762         RETURN                  ; RETORNA DA INTERRUPÇÃO
                      00763 
                      00764 ;*      *       *       *       *       *       *       *       *       *
                      00765 ;*                  ROTINA PARA ATUALIZAR A TELA DO RPS                 *
                      00766 ;*      *       *       *       *       *       *       *       *       *
                      00767 
0164                  00768 ATUALIZA_TELA_RPS
                      00769         
0164   30C0           00770         MOVLW   0xC0            ; POSICIONA INÍCIO DE ESCRITA NO DISPLAY
0165   2099           00771         CALL    ENVIA_COMANDO   ; CHAMA ROTINA PARA ENVIAR O COMANDO
                      00772         
0166   0831           00773         MOVF    CONVERSAO_2,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
0167   3E30           00774         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
0168   209A           00775         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00776 
0169   0832           00777         MOVF    CONVERSAO_1,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
016A   3E30           00778         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
016B   209A           00779         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00780         
016C   0833           00781         MOVF    CONVERSAO_0,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
016D   3E30           00782         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
016E   209A           00783         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00784         
016F   0008           00785         RETURN                  ; RETORNA DA INTERRUPÇÃO
                      00786         
                      00787 ;*      *       *       *       *       *       *       *       *       *
                      00788 ;*                  ROTINA PARA ATUALIZAR A TELA DO RPM                 *
                      00789 ;*      *       *       *       *       *       *       *       *       *
                      00790 
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0170                  00791 ATUALIZA_RPM
                      00792 
0170   30C6           00793         MOVLW   0xC6            ; POSICIONA A POSIÇÃO NO DISPLAY
0171   2099           00794         CALL    ENVIA_COMANDO   ; ENVIA COMANDO PARA O DISPLAY
                      00795         
0172   0830           00796         MOVF    CONVERSAO_3,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
0173   3E30           00797         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
0174   209A           00798         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00799         
0175   0831           00800         MOVF    CONVERSAO_2,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
0176   3E30           00801         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
0177   209A           00802         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00803         
0178   0832           00804         MOVF    CONVERSAO_1,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
0179   3E30           00805         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
017A   209A           00806         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00807         
017B   0833           00808         MOVF    CONVERSAO_0,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
017C   3E30           00809         ADDLW   0x30            ; TRANSFORMA  O DADO EM PRINTÁVEL
017D   209A           00810         CALL    ENVIA_DADO      ; ENVIA  O DADO PARA O DISPLAY
                      00811         
017E   0008           00812         RETURN                  ; RETORNA DA INTERRUPÇÃO
                      00813 
                      00814 ;*      *       *       *       *       *       *       *       *       *
                      00815 ;*                  ROTINA PARA ATUALIZAR A TEMPERATURA                 *
                      00816 ;*      *       *       *       *       *       *       *       *       *
                      00817 
017F                  00818 ATUALIZA_TEMPERATURA
                      00819         
017F   1003           00820         BCF     STATUS,C        ; LIMPA O BIT DE STATUS         
0180   0D1E           00821         RLF     ADRESH,W        ; MULTIPLICA O RESULTADO POR 2
0181   00B5           00822         MOVWF   LSB             ; MOVE RESULTADO PARA LSB
0182   01B4           00823         CLRF    MSB
0183   218D           00824         CALL    BIN_TO_DEC      ; CHAMA ROTINA DE CONVERSÃO PARA DECIMAL
                      00825         
0184   30CD           00826         MOVLW   0xCD            ; POSICIONA O DISPLAY
0185   2099           00827         CALL    ENVIA_COMANDO
                      00828                 
0186   0832           00829         MOVF    CONVERSAO_1,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
0187   3E30           00830         ADDLW   0x30            ; ADICIONA VALOR PARA FICAR PRINTÁVEL
0188   209A           00831         CALL    ENVIA_DADO      ; ESCREVE O DADO NO DISPLAY     
                      00832         
0189   0833           00833         MOVF    CONVERSAO_0,W   ; MOVE RESULTADO DA CONVERSÃO PARA W
018A   3E30           00834         ADDLW   0x30            ; ADICIONA VALOR PARA FICAR PRINTÁVEL
018B   209A           00835         CALL    ENVIA_DADO      ; ESCREVE O DADO NO DISPLAY     
                      00836 
018C   0008           00837         RETURN                  ; RETORNA DA ROTINA
                      00838         
                      00839 ;*      *       *       *       *       *       *       *       *       *
                      00840 ;*                ROTINA DE CONVERSÃO BINÁRIO PARA DECIMAL              *
                      00841 ;*                           ENTRADAS: MSB:LSB                          *
                      00842 ;*  SAÍDA: CONVERSAO_4:CONVERSAO_3:CONVERSAO_2:CONVERSAO_1:CONVERSAO_0  *
                      00843 ;*      *       *       *       *       *       *       *       *       *
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00844 
018D                  00845 BIN_TO_DEC
                      00846         
018D   01B3           00847         CLRF    CONVERSAO_0     ; INICIALIZA VARIÁVEIS DE CONVERSÃO
018E   01B2           00848         CLRF    CONVERSAO_1
018F   01B1           00849         CLRF    CONVERSAO_2
0190   01B0           00850         CLRF    CONVERSAO_3
0191   01AF           00851         CLRF    CONVERSAO_4
                      00852                 
0192   08B5           00853         MOVF    LSB,F           ; VERIFICA SE ALGUMA DAS VARIÁVEIS É NULA
0193   1D03           00854         BTFSS   STATUS,Z
0194   299B           00855         GOTO    INC_MSB
                      00856         
0195   08B4           00857         MOVF    MSB,F
0196   1903           00858         BTFSC   STATUS,Z
0197   0008           00859         RETURN
                      00860         
0198   08B5           00861         MOVF    LSB,F
0199   1903           00862         BTFSC   STATUS,Z
019A   299C           00863         GOTO    CONVERSAO_A
                      00864         
019B                  00865 INC_MSB 
                      00866 
019B   0AB4           00867         INCF    MSB,F
                      00868                 
019C                  00869 CONVERSAO_A
                      00870 
019C   0064           00871         CLRWDT  
019D   0AB3           00872         INCF    CONVERSAO_0,F           ; FAZ A CONVERSÃO DO
019E   300A           00873         MOVLW   .10                     ; RESULTADO PASSADO COMO ARGUMENTO
019F   0633           00874         XORWF   CONVERSAO_0,W
01A0   1D03           00875         BTFSS   STATUS,Z
01A1   29B6           00876         GOTO    CONVERSAO_B
                      00877         
01A2   01B3           00878         CLRF    CONVERSAO_0
01A3   0AB2           00879         INCF    CONVERSAO_1,F
01A4   300A           00880         MOVLW   .10
01A5   0632           00881         XORWF   CONVERSAO_1,W
01A6   1D03           00882         BTFSS   STATUS,Z
01A7   29B6           00883         GOTO    CONVERSAO_B
                      00884         
01A8   01B2           00885         CLRF    CONVERSAO_1
01A9   0AB1           00886         INCF    CONVERSAO_2,F
01AA   300A           00887         MOVLW   .10
01AB   0631           00888         XORWF   CONVERSAO_2,W
01AC   1D03           00889         BTFSS   STATUS,Z
01AD   29B6           00890         GOTO    CONVERSAO_B
                      00891         
01AE   01B1           00892         CLRF    CONVERSAO_2
01AF   0AB0           00893         INCF    CONVERSAO_3,F
01B0   300A           00894         MOVLW   .10
01B1   0630           00895         XORWF   CONVERSAO_3,W
01B2   1D03           00896         BTFSS   STATUS,Z
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01B3   29B6           00897         GOTO    CONVERSAO_B
                      00898         
01B4   01B0           00899         CLRF    CONVERSAO_3
01B5   0AAF           00900         INCF    CONVERSAO_4,F
                      00901         
01B6                  00902 CONVERSAO_B     
                      00903 
01B6   0BB5           00904         DECFSZ  LSB,F
01B7   299C           00905         GOTO    CONVERSAO_A
                      00906         
01B8   0BB4           00907         DECFSZ  MSB,F
01B9   299C           00908         GOTO    CONVERSAO_A
                      00909                 
01BA   0008           00910         RETURN  
                      00911                         
                      00912 ;*      *       *       *       *       *       *       *       *       *
                      00913 ;*                        CONFIGURACOES INICIAIS                        *
                      00914 ;*      *       *       *       *       *       *       *       *       *
                      00915 
01BB                  00916 CONFIG_
                      00917 
01BB   0185           00918         CLRF    PORTA           ; LIMPA O PORTA
01BC   0186           00919         CLRF    PORTB           ; LIMPA O PORTB
01BD   0187           00920         CLRF    PORTC           ; LIMPA O PORTC
01BE   0188           00921         CLRF    PORTD           ; LIMPA O PORTD
01BF   0189           00922         CLRF    PORTE           ; LIMPA O PORTE
                      00923         
01C0   1683           00924         BANK1                   ; SELECIONA BANCO1 DE MEMÓRIA
                      00925         
01C1   30FF           00926         MOVLW   B'11111111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C2   0085           00927         MOVWF   TRISA
                      00928         
01C3   30C0           00929         MOVLW   B'11000000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C4   0086           00930         MOVWF   TRISB           ; CONFIGURA I/O DO PORTB
                      00931         
01C5   30D9           00932         MOVLW   B'11011001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C6   0087           00933         MOVWF   TRISC           ; CONFIGURA I/O DO PORTB
                      00934         
01C7   3000           00935         MOVLW   B'00000000'     ; CONFIGURA TODOS OS PINOS DESTE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01C8   0088           00936         MOVWF   TRISD           ; PORTB COMO SAÍDA
                      00937         
01C9   3001           00938         MOVLW   B'00000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01CA   0089           00939         MOVWF   TRISE           ; CONFIGURA I/O DO PORTE
                      00940         
01CB   308F           00941         MOVLW   B'10001111'     ; DESLIGA PULL-UPS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01CC   0081           00942         MOVWF   OPTION_REG      ; WDT 1:128
                      00943         
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01CD   3002           00944         MOVLW   B'00000010'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01CE   008C           00945         MOVWF   PIE1            ; HABILITA INTERRUPÇÃO DE TIMER2
                      00946         
01CF   3040           00947         MOVLW   B'01000000'     
01D0   008B           00948         MOVWF   INTCON          ; HABILITA A INTERRUPÇÃO DOS PERIFÉRICOS
                      00949                                 ; LIGA A CHAVE GERAL DE INTERRUPÇÃO
                      00950         
01D1   3004           00951         MOVLW   B'00000100'     ; RA0, RA1 E RA3 COMO ENTRADA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01D2   009F           00952         MOVWF   ADCON1          ; ANALÓGICA
                      00953         
01D3   30F9           00954         MOVLW   .249
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01D4   0092           00955         MOVWF   PR2             ; CONFIGURA BASE DE TEMPO PARA 4kHz
                      00956         
01D5   1283           00957         BANK0
                      00958         
01D6   3059           00959         MOVLW   B'01011001'
01D7   009F           00960         MOVWF   ADCON0          ; LIGA O A/D
                      00961         
01D8   018E           00962         CLRF    TMR1L
01D9   018F           00963         CLRF    TMR1H
01DA   3007           00964         MOVLW   B'00000111'
01DB   0090           00965         MOVWF   T1CON           ; PRESCALE 1:1
                      00966                                 ; TIMER 1 COMO CONTADOR EXTERNO
                      00967         
01DC   304D           00968         MOVLW   B'01001101'
01DD   0092           00969         MOVWF   T2CON           ; TIMER 2 ON
                      00970                                 ; PRESCALER 1:4
                      00971                                 ; POSTSCALE 1:10
                      00972         
01DE   300F           00973         MOVLW   B'00001111'
01DF   0097           00974         MOVWF   CCP1CON
01E0   009D           00975         MOVWF   CCP2CON         ; CONFIGURA CCP PARA MODO PWM
                      00976         
01E1   0195           00977         CLRF    CCPR1L
01E2   019B           00978         CLRF    CCPR2L          ; INICIALIZA OS MÓDULOS 
                      00979         
01E3   1A03           00980         BTFSC   STATUS,NOT_TO   ; ESTOURO POR WDT?
01E4   29E4           00981         GOTO    $               ; NÃO, ENTÃO AGUARDA
                      00982                 
01E5                  00983 LIMPEZA_DA_RAM
                      00984                                 ; ROTINA DE LIMPEZA DA RAM
                      00985                                 
01E5   3020           00986         MOVLW   0x20
01E6   0084           00987         MOVWF   FSR
01E7   0180           00988         CLRF    INDF
01E8   0A84           00989         INCF    FSR,F
01E9   3080           00990         MOVLW   0x80
01EA   0604           00991         XORWF   FSR,W
01EB   1D03           00992         BTFSS   STATUS,Z
01EC   29E7           00993         GOTO    $-5
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00994 
01ED   3064           00995         MOVLW   .100
01EE   00AB           00996         MOVWF   VEZES_TIMER2    ; CARREGA VEZES_TIMER2
                      00997         
01EF   178B           00998         BSF     INTCON,GIE      ; LIGA AS INTERRUPÇÕES
                      00999         
                      01000 ;*      *       *       *       *       *       *       *       *       *
                      01001 ;*                       INICIALIZAÇÃO DO DISPLAY                       *
                      01002 ;*      *       *       *       *       *       *       *       *       *
                      01003         
                      01004 
                      01005 
01F0   3030           01006         MOVLW   0x30                    
01F1   2099           01007         CALL    ENVIA_COMANDO           ; COMANDO DE INICIALIZAÇÃO
                      01008         
01F2   3003           01009         MOVLW   .3                      
01F3   2090           01010         CALL    DELAY_MS                ; DELAY DE 3ms
                      01011         
01F4   3030           01012         MOVLW   0x30                    
01F5   2099           01013         CALL    ENVIA_COMANDO           ; COMANDO DE INICIALIZAÇÃO      
                      01014         
01F6   3030           01015         MOVLW   0x30                    
01F7   2099           01016         CALL    ENVIA_COMANDO           ; COMANDO DE INICIALIZAÇÃO
                      01017         
01F8   3038           01018         MOVLW   0x38                    
01F9   2099           01019         CALL    ENVIA_COMANDO           ; INTERFACE DE 8 VIAS
                      01020         
01FA   3001           01021         MOVLW   0x01                    
01FB   2099           01022         CALL    ENVIA_COMANDO           ; LIMPA O DISPLAY
                      01023         
01FC   3001           01024         MOVLW   .1
01FD   2090           01025         CALL    DELAY_MS                ; CHAMA DELAY DE 3ms
                      01026         
01FE   300C           01027         MOVLW   0x0C                    
01FF   2099           01028         CALL    ENVIA_COMANDO           ; LIGAR O DISPLAY SEM CURSOR
                      01029         
0200   3006           01030         MOVLW   0x06                    
0201   2099           01031         CALL    ENVIA_COMANDO           ; LIGAR O DISPLAY SEM CURSOR
                      01032         
                      01033                                                                 
                      01034 ;*      *       *       *       *       *       *       *       *       *
                      01035 ;*                       INICIALIZAÇÃO DAS VARIÁVEIS                    *
                      01036 ;*      *       *       *       *       *       *       *       *       *
                      01037         
0202   20A6           01038         CALL    ATUALIZA_TELA           ; CHAMA ROTINA PARA ATUALIZAR
                      01039                                         ; A TELA DA PLACA
                      01040                 
                      01041 ;*      *       *       *       *       *       *       *       *       *
                      01042 ;*                          ROTINA PRINCIPAL                            *
                      01043 ;*      *       *       *       *       *       *       *       *       *
                      01044 
0203                  01045 LOOP
0203   0064           01046         CLRWDT                  ; LIMPA O WATCHDOG
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01047         
0204   182C           01048         BTFSC   MOSTRA_RPS_RPM  ; DEVE ATUALIZAR O DISPLAY?
0205   214B           01049         CALL    ATUALIZA_RPS_RPM ; SIM, ENTÃO CHAMA A ROTINA
                      01050         
0206   151F           01051         BSF     ADCON0,GO       ; LIGA O AD
                      01052         
0207   191F           01053         BTFSC   ADCON0,GO       ; AGUARDA O FIM DA CONVERSÃO
0208   2A07           01054         GOTO    $-1
                      01055         
0209   217F           01056         CALL    ATUALIZA_TEMPERATURA ; CHAMA ROTINA PARA ATUALIZAR 
                      01057                                      ; TEMPERATURA
                      01058                         
020A                  01059 AJUSTA_CCP1
                      01060         
020A   3083           01061         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
020B   18A2           01062         BTFSC   TECLA_1         ; A TECLA ESTÁ PRESSIONADA?
020C   20EB           01063         CALL    ATUALIZA_0      ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01064         
020D   3083           01065         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
020E   1922           01066         BTFSC   TECLA_2         ; A TECLA ESTÁ PRESSIONADA?
020F   20FB           01067         CALL    ATUALIZA_20     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01068         
0210   3083           01069         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0211   19A2           01070         BTFSC   TECLA_3         ; A TECLA ESTÁ PRESSIONADA?
0212   210B           01071         CALL    ATUALIZA_40     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01072         
0213   3083           01073         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0214   1A22           01074         BTFSC   TECLA_4         ; A TECLA ESTÁ PRESSIONADA?
0215   211B           01075         CALL    ATUALIZA_60     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01076         
0216   3083           01077         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0217   1AA2           01078         BTFSC   TECLA_5         ; A TECLA ESTÁ PRESSIONADA?
0218   212B           01079         CALL    ATUALIZA_80     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01080         
0219   3083           01081         MOVLW   0x83            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
021A   1B22           01082         BTFSC   TECLA_6         ; A TECLA ESTÁ PRESSIONADA?
021B   213B           01083         CALL    ATUALIZA_100    ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01084 
021C                  01085 AJUSTA_CCP2
                      01086         
021C   308C           01087         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
021D   1BA2           01088         BTFSC   TECLA_7         ; A TECLA ESTÁ PRESSIONADA?
021E   20EB           01089         CALL    ATUALIZA_0      ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01090         
021F   308C           01091         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0220   1823           01092         BTFSC   TECLA_8         ; A TECLA ESTÁ PRESSIONADA?
0221   20FB           01093         CALL    ATUALIZA_20     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01094         
0222   308C           01095         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0223   18A3           01096         BTFSC   TECLA_9         ; A TECLA ESTÁ PRESSIONADA?
0224   210B           01097         CALL    ATUALIZA_40     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01098         
0225   308C           01099         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0226   1923           01100         BTFSC   TECLA_C         ; A TECLA ESTÁ PRESSIONADA?
0227   211B           01101         CALL    ATUALIZA_60     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01102         
0228   308C           01103         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
0229   1822           01104         BTFSC   TECLA_0         ; A TECLA ESTÁ PRESSIONADA?
022A   212B           01105         CALL    ATUALIZA_80     ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01106         
022B   308C           01107         MOVLW   0x8C            ; MOVE POSIÇÃO INICIAL DA MENSAGEM
022C   19A3           01108         BTFSC   TECLA_E         ; A TECLA ESTÁ PRESSIONADA?
022D   213B           01109         CALL    ATUALIZA_100    ; SIM, ENTÃO CHAMA A ROTINA DE ATUALIZAÇÃO
                      01110         
022E   2A03           01111         GOTO    LOOP            ; SALTA PARA O LOOP PRINCIPAL
                      01112                 
                      01113 ;*      *       *       *       *       *       *       *       *       *
                      01114 ;*                           FIM DO PROGRAMA                            *
                      01115 ;*      *       *       *       *       *       *       *       *       *
                      01116 
                      01117 
                      01118         END                     ; FIM DO PROGRAMA
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AJUSTA_CCP1                       0000020A
AJUSTA_CCP2                       0000021C
ARG0                              00000026
ARG1                              00000027
ARG2                              00000028
ATUALIZA_0                        000000EB
ATUALIZA_100                      0000013B
ATUALIZA_20                       000000FB
ATUALIZA_40                       0000010B
ATUALIZA_60                       0000011B
ATUALIZA_80                       0000012B
ATUALIZA_RPM                      00000170
ATUALIZA_RPS_RPM                  0000014B
ATUALIZA_TELA                     000000A6
ATUALIZA_TELA_RPS                 00000164
ATUALIZA_TEMPERATURA              0000017F
BANK0                             BCF     STATUS,RP0
BANK1                             BSF     STATUS,RP0
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BIN_TO_DEC                        0000018D
BRGH                              00000002
BUS                               PORTD
C                                 00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CKE                               00000006
CKP                               00000004
COL1                              PORTA,4
COL2                              PORTA,5
COL3                              PORTE,0
CONFIG_                           000001BB
CONTADOR_LSB                      0000002D
CONTADOR_MSB                      0000002E
CONVERSAO_0                       00000033
CONVERSAO_1                       00000032
CONVERSAO_2                       00000031
CONVERSAO_3                       00000030
CONVERSAO_4                       0000002F
CONVERSAO_A                       0000019C
CONVERSAO_B                       000001B6
CREN                              00000004
CSRC                              00000007
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DELAY_A                           00000093
DELAY_MS                          00000090
DIVIDE                            00000078
DIVIDE_A                          00000083
DIVIDE_B                          0000008B
DIVIDE_C                          00000087
D_A                               00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EN                                PORTE,2
ENVIA_COMANDO                     00000099
ENVIA_DADO                        0000009A
F                                 00000001
FERR                              00000002
FLAGS                             0000002C
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

FSR                               00000004
FSR_TEMP                          00000072
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INC_MSB                           0000019B
INDF                              00000000
INDICE                            00000024
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
LIMPEZA_DA_RAM                    000001E5
LINHA_INF                         0xC0
LINHA_SUP                         0x80
LOOP                              00000203
LSB                               00000035
MOSTRA_RPS_RPM                    FLAGS,0
MSB                               00000034
MUL0                              0000002A
MUL1                              00000029
MULT                              0000006A
MULTIPLICACAO                     00000062
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

PCL                               00000002
PCLATH                            0000000A
PCLATH_TEMP                       00000073
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RS                                PORTE,1
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_W                               00000002
S                                 00000003
SAI_COM_DADO                      00000070
SAI_EM_0                          00000075
SAI_INTERRUPCAO                   00000011
SALVA_CONTEXTO                    00000004
SEL_LINHA1                        B'00001110'
SEL_LINHA2                        B'00001101'
SEL_LINHA3                        B'00001011'
SEL_LINHA4                        B'00000111'
SEN                               00000000
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STATUS_TEMP                       00000071
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TECLADO1                          00000022
TECLADO2                          00000023
TECLA_0                           TECLADO1,0
TECLA_1                           TECLADO1,1
TECLA_2                           TECLADO1,2
TECLA_3                           TECLADO1,3
TECLA_4                           TECLADO1,4
TECLA_5                           TECLADO1,5
TECLA_6                           TECLADO1,6
TECLA_7                           TECLADO1,7
TECLA_8                           TECLADO2,0
TECLA_9                           TECLADO2,1
TECLA_C                           TECLADO2,2
TECLA_E                           TECLADO2,3
TEMP                              00000025
TEMPO1                            00000020
TEMPO2                            00000021
TMR0                              00000001
TMR1CS                            00000001
TMR1H                             0000000F
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 28


SYMBOL TABLE
  LABEL                             VALUE 

TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRATA_TIMER0                      0000001A
TRATA_TIMER2                      00000053
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
VERIFICA_LINHA1                   00000023
VERIFICA_LINHA2                   0000002F
VERIFICA_LINHA3                   0000003B
VERIFICA_LINHA4                   00000047
VEZES_TIMER2                      0000002B
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
W_TEMP                            00000070
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
MPASM 03.80.04 Internal                               PWM.ASM   5-15-2005  9:46:48         PAGE 29


SYMBOL TABLE
  LABEL                             VALUE 

_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : X---XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXX- ----------------
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   556
Program Memory Words Free:  7636


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    11 reported,     0 suppressed

